<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>ã»ã†ã›ã„RPG 2 ã€œæ¿€é—˜ï¼ç¤¾ä¼šã®è’æ³¢ã€œ</title>
<style>
    :root {
        --bg-color: #2c3e50;
        --map-bg: #ecf0f1;
        --text-color: #ecf0f1;
        --highlight: #e74c3c;
        --ui-bg: #34495e;
    }
    body {
        background-color: var(--bg-color);
        color: var(--text-color);
        font-family: 'Pixel', 'Courier New', monospace;
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        height: 100vh;
        overflow: hidden;
    }
    h1 { margin: 5px 0; font-size: 1.2rem; text-shadow: 2px 2px 0 #000; }
    
    /* Game Area */
    #game-container {
        position: relative;
        width: 320px;
        height: 320px;
        background: var(--map-bg);
        border: 4px solid #95a5a6;
        image-rendering: pixelated;
        overflow: hidden;
    }
    
    .tile {
        position: absolute;
        width: 32px;
        height: 32px;
        font-size: 24px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: default;
    }
    
    #player {
        z-index: 10;
        transition: top 0.1s, left 0.1s;
    }

    /* UI Panels */
    #ui-panel {
        width: 320px;
        background: var(--ui-bg);
        padding: 5px;
        box-sizing: border-box;
        border: 2px solid #7f8c8d;
        font-size: 0.8rem;
    }

    .stat-row { display: flex; justify-content: space-between; margin-bottom: 2px; }
    .stat-val { font-weight: bold; color: #f1c40f; }
    .danger { color: #e74c3c !important; animation: blink 1s infinite; }

    #log-box {
        width: 320px;
        height: 80px;
        background: #000;
        color: #0f0;
        font-size: 0.7rem;
        padding: 5px;
        overflow-y: scroll;
        box-sizing: border-box;
        border: 2px solid #7f8c8d;
        margin-top: 5px;
        font-family: monospace;
    }

    /* Controls */
    #controls {
        display: grid;
        grid-template-columns: 1fr 1fr 1fr;
        gap: 5px;
        margin-top: 10px;
        width: 200px;
    }
    button {
        background: #95a5a6;
        border: 2px solid #fff;
        padding: 10px;
        font-weight: bold;
        cursor: pointer;
        border-radius: 4px;
    }
    button:active { background: #7f8c8d; transform: scale(0.95); }
    #btn-act { grid-column: 2; background: #e67e22; color: white; }

    /* Modal */
    .modal {
        display: none;
        position: fixed;
        top: 0; left: 0; width: 100%; height: 100%;
        background: rgba(0,0,0,0.8);
        justify-content: center;
        align-items: center;
        z-index: 100;
    }
    .modal-content {
        background: #fff;
        color: #000;
        padding: 20px;
        width: 300px;
        border-radius: 5px;
        text-align: center;
    }
    .shop-item {
        border: 1px solid #ccc;
        padding: 5px;
        margin: 5px 0;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
    }
    .shop-item:hover { background: #eee; }

    @keyframes blink { 50% { opacity: 0.5; } }
</style>
</head>
<body>

<h1>ã»ã†ã›ã„RPG 2 ã€œæ¿€é—˜ï¼ç¤¾ä¼šã®è’æ³¢ã€œ</h1>

<div id="ui-panel">
    <div class="stat-row">
        <span>è·æ¥­: <span id="s-job">ãƒ‹ãƒ¼ãƒˆ</span></span>
        <span>æ‰€æŒé‡‘: <span id="s-money" class="stat-val">0</span>å††</span>
    </div>
    <div class="stat-row">
        <span>ä½“åŠ›(HP): <span id="s-hp">100</span></span>
        <span>æº€è…¹åº¦: <span id="s-food">100</span></span>
        <span>ã‚¹ãƒˆãƒ¬ã‚¹: <span id="s-stress">0</span></span>
    </div>
</div>

<div id="game-container">
    <div id="player" class="tile">ğŸ˜</div>
</div>

<div id="log-box">
    <div>ã‚²ãƒ¼ãƒ é–‹å§‹ã€‚ç¤¾ä¼šã®å³ã—ã•ã‚’æ€ã„çŸ¥ã‚Œã€‚</div>
</div>

<div id="controls">
    <button onclick="move(0, -1)">â–²</button>
    <button id="btn-act" onclick="interact()">ACT</button>
    <button onclick="move(0, 1)">â–¼</button>
    <button onclick="move(-1, 0)">â—€</button>
    <button onclick="move(1, 0)">â–¶</button>
</div>

<div id="modal" class="modal">
    <div class="modal-content">
        <h2 id="modal-title">ã‚¿ã‚¤ãƒˆãƒ«</h2>
        <div id="modal-body">å†…å®¹</div>
        <button onclick="closeModal()" style="margin-top:10px; width:100%; background:#333; color:white;">é–‰ã˜ã‚‹</button>
    </div>
</div>

<script>
    // --- Config ---
    const TILE_SIZE = 32;
    const MAP_WIDTH = 10;
    const MAP_HEIGHT = 10;

    // --- State ---
    const state = {
        x: 1, y: 1, // Player pos
        money: 1000,
        hp: 100,
        maxHp: 100,
        food: 100,
        maxFood: 100,
        stress: 0,
        maxStress: 100,
        job: 'neet',
        inventory: { suit: false },
        turn: 0
    };

    // --- Map Data ---
    // .: Road, H: Home, W: HelloWork, C: Company, P: Park, S: Shop, +: Hospital
    // â– : Wall
    const mapLayout = [
        "â– â– â– â– â– â– â– â– â– â– ",
        "â– H......Sâ– ",
        "â– ........â– ",
        "â– ..P..P..â– ",
        "â– ..P..P..â– ",
        "â– ........â– ",
        "â– W......Câ– ",
        "â– ........â– ",
        "â– ...+....â– ",
        "â– â– â– â– â– â– â– â– â– â– "
    ];

    const tiles = {
        'H': { icon: 'ğŸ ', name: 'å®Ÿå®¶', color: '#f1c40f' },
        'W': { icon: 'ğŸ¢', name: 'ãƒãƒ­ãƒ¼ãƒ¯ãƒ¼ã‚¯', color: '#3498db' },
        'C': { icon: 'ğŸ­', name: 'è¬ç½ªä»£è¡Œç¤¾', color: '#2c3e50' },
        'P': { icon: 'ğŸŒ³', name: 'å…¬åœ’', color: '#27ae60' },
        'S': { icon: 'ğŸª', name: 'ã‚³ãƒ³ãƒ“ãƒ‹', color: '#e67e22' },
        '+': { icon: 'ğŸ¥', name: 'ãƒ¤ãƒ–åŒ»è€…', color: '#e74c3c' },
        '.': { icon: '', name: 'é“', color: '#ecf0f1' },
        'â– ': { icon: '', name: 'å£', color: '#95a5a6' }
    };

    const jobs = {
        neet: { name: "ãƒ‹ãƒ¼ãƒˆ", salary: 0, desc: "å®Ÿå®¶ã®è­¦å‚™ã€‚åå…¥ãªã—ã€‚" },
        can: { name: "ç©ºãç¼¶æ‹¾ã„", salary: 500, desc: "å…¬åœ’ã§æ´»å‹•ã€‚ä½“åŠ›ã‚’ä½¿ã†ã€‚" },
        apology: { name: "è¬ç½ªä»£è¡Œ", salary: 10000, desc: "é«˜åå…¥ã ãŒã‚¹ãƒˆãƒ¬ã‚¹ã§æ­»ã¬ã€‚è¦ã‚¹ãƒ¼ãƒ„ã€‚" },
        monitor: { name: "æ²»é¨“", salary: 5000, desc: "æ¥½ã ãŒHPãŒãƒ©ãƒ³ãƒ€ãƒ ã§æ¸›ã‚‹ã€‚" }
    };

    // --- Init ---
    const container = document.getElementById('game-container');
    const playerEl = document.getElementById('player');
    
    function initMap() {
        for(let y=0; y<MAP_HEIGHT; y++) {
            for(let x=0; x<MAP_WIDTH; x++) {
                const char = mapLayout[y][x];
                const tileInfo = tiles[char] || tiles['.'];
                const div = document.createElement('div');
                div.className = 'tile';
                div.style.left = (x * TILE_SIZE) + 'px';
                div.style.top = (y * TILE_SIZE) + 'px';
                div.innerText = tileInfo.icon;
                if(char === 'â– ') div.style.backgroundColor = '#7f8c8d';
                
                // Debug visuals for special spots
                if(tileInfo.name !== 'é“' && tileInfo.name !== 'å£') {
                    div.style.border = `1px dashed ${tileInfo.color}`;
                }
                
                container.appendChild(div);
            }
        }
        updatePlayerPos();
        updateUI();
    }

    // --- Core Logic ---
    function move(dx, dy) {
        if(state.hp <= 0) return; // Dead

        const newX = state.x + dx;
        const newY = state.y + dy;

        if (mapLayout[newY][newX] === 'â– ') {
            log("å£ã ã€‚é€²ã‚ãªã„ã€‚");
            return;
        }

        state.x = newX;
        state.y = newY;
        
        // Step costs
        state.food -= 2;
        if(state.food < 0) {
            state.food = 0;
            state.hp -= 5;
            log("è…¹ãŒæ¸›ã‚Šã™ãã¦è¦–ç•ŒãŒéœã‚€...", "bad");
        }
        
        state.turn++;
        
        // Random Encounters (5% chance)
        if(Math.random() < 0.05) randomEvent();

        updatePlayerPos();
        updateUI();
        checkGameOver();
    }

    function updatePlayerPos() {
        playerEl.style.left = (state.x * TILE_SIZE) + 'px';
        playerEl.style.top = (state.y * TILE_SIZE) + 'px';
        
        // Change face based on status
        let face = "ğŸ˜";
        if(state.stress > 50) face = "ğŸ˜“";
        if(state.stress > 80) face = "ğŸ˜±";
        if(state.hp < 30) face = "ğŸ¤¢";
        if(state.job === 'apology') face = "ğŸ™‡";
        playerEl.innerText = face;
    }

    function interact() {
        if(state.hp <= 0) return;

        const tileChar = mapLayout[state.y][state.x];
        const tile = tiles[tileChar];

        log(`${tile.name}ã«ã„ã‚‹ã€‚`);

        switch(tileChar) {
            case 'H': homeEvent(); break;
            case 'W': helloWorkEvent(); break;
            case 'S': shopEvent(); break;
            case 'P': parkEvent(); break;
            case 'C': companyEvent(); break;
            case '+': hospitalEvent(); break;
            default: log("ã“ã“ã§ã¯ç‰¹ã«ä½•ã‚‚ã§ããªã„ã€‚");
        }
        updateUI();
    }

    // --- Events & Locations ---

    function homeEvent() {
        openModal("å®Ÿå®¶", `
            <p>ãƒãƒã€Œã‚ã‚‰ã€ã»ã†ã›ã„ã¡ã‚ƒã‚“ã€‚ã”é£¯é£Ÿã¹ã‚‹ï¼Ÿã€</p>
            <button onclick="action('rest_home')">å¯ã‚‹ (HPãƒ»ã‚¹ãƒˆãƒ¬ã‚¹å›å¾© / 0å††)</button>
            <button onclick="action('eat_mom')">ãƒãƒã®ã”é£¯ (æº€è…¹åº¦å›å¾© / -500å††)</button>
            <p style="font-size:0.7rem; color:red;">â€»ãƒ‹ãƒ¼ãƒˆä»¥å¤–ã ã¨è¦ªã®è¦–ç·šãŒç—›ã„</p>
        `);
    }

    function helloWorkEvent() {
        let html = `<p>è·ã‚’æ¢ã—ã¾ã™ã‹ï¼Ÿ</p>`;
        for(let key in jobs) {
            if(key === state.job) continue;
            html += `<div class="shop-item" onclick="action('change_job', '${key}')">
                <b>${jobs[key].name}</b>
                <small>${jobs[key].desc}</small>
            </div>`;
        }
        openModal("ãƒãƒ­ãƒ¼ãƒ¯ãƒ¼ã‚¯", html);
    }

    function shopEvent() {
        openModal("ã‚³ãƒ³ãƒ“ãƒ‹", `
            <div class="shop-item" onclick="action('buy', 'onigiri')">
                <span>å»ƒæ£„å¯¸å‰ãŠã«ãã‚Š (æº€è…¹+30)</span> <b>300å††</b>
            </div>
            <div class="shop-item" onclick="action('buy', 'zero')">
                <span>ã‚¹ãƒˆãƒ­ãƒ³ã‚°ã‚¼ãƒ­ (ã‚¹ãƒˆãƒ¬ã‚¹-30 / HP-10)</span> <b>200å††</b>
            </div>
            <div class="shop-item" onclick="action('buy', 'suit')">
                <span>ãƒªã‚¯ãƒ«ãƒ¼ãƒˆã‚¹ãƒ¼ãƒ„ (å°±è·ã«å¿…è¦)</span> <b>20000å††</b>
            </div>
        `);
    }

    function parkEvent() {
        let html = `<p>å…¬åœ’ã§ã™ã€‚</p>`;
        
        if(state.job === 'can') {
            html += `<button onclick="action('work_can')">ç©ºãç¼¶ã‚’æ¢ã™ (åå…¥å° / ã‚¹ãƒˆãƒ¬ã‚¹ä¸­)</button>`;
        } else {
            html += `<p>ç©ºãç¼¶æ‹¾ã„ã®ãƒ—ãƒ­ã˜ã‚ƒãªã„ã¨ã€ã„ã„ç©ºãç¼¶ã¯è¦‹ã¤ã‹ã‚‰ãªã„ã€‚</p>`;
        }
        
        html += `<button onclick="action('rest_park')">ãƒ™ãƒ³ãƒã§å¯ã‚‹ (HPå¾®å›å¾© / æº€è…¹æ¸›)</button>`;
        openModal("å…¬åœ’", html);
    }

    function companyEvent() {
        if(state.job === 'apology') {
            openModal("è¬ç½ªä»£è¡Œç¤¾", `
                <p>æœ¬æ—¥ã®ä¾é ¼ï¼šã‚¯ãƒ¬ãƒ¼ãƒãƒ¼ã¸ã®åœŸä¸‹åº§</p>
                <button onclick="action('work_apology')">å‡ºå‹¤ã™ã‚‹ (åå…¥å¤§ / ã‚¹ãƒˆãƒ¬ã‚¹ç‰¹å¤§)</button>
            `);
        } else if(state.job === 'monitor') {
            openModal("æ€ªã—ã„ç ”ç©¶æ‰€", `
                <p>æ²»é¨“ãƒã‚¤ãƒˆä¼šå ´</p>
                <button onclick="action('work_monitor')">è–¬ã‚’é£²ã‚€ (åå…¥ä¸­ / ãƒªã‚¹ã‚¯æœ‰)</button>
            `);
        } else {
            log("é–¢ä¿‚è€…ä»¥å¤–ç«‹ã¡å…¥ã‚Šç¦æ­¢ã¨æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚", "bad");
            closeModal();
        }
    }

    function hospitalEvent() {
        openModal("ãƒ¤ãƒ–åŒ»è€…", `
            <p>åŒ»è€…ã€Œé‡‘ã•ãˆã‚ã‚Œã°æ²»ã—ã¦ã‚„ã‚‹ã€</p>
            <button onclick="action('heal_hp')">æ²»ç™‚ã™ã‚‹ (HPå…¨å¿« / 5000å††)</button>
            <button onclick="action('heal_stress')">ç²¾ç¥å®‰å®šå‰¤ (ã‚¹ãƒˆãƒ¬ã‚¹0 / 3000å††)</button>
        `);
    }

    // --- Actions Processing ---

    function action(type, param) {
        closeModal();
        let success = true;

        if (type === 'rest_home') {
            state.hp = state.maxHp;
            state.stress -= 50;
            if(state.job !== 'neet') {
                log("è¦ªã€Œåƒã„ã¦ã‚‹ã®ã«å®¶ã«ãŠé‡‘å…¥ã‚Œãªã„ã®ï¼Ÿã€(ã‚¹ãƒˆãƒ¬ã‚¹+10)", "bad");
                state.stress += 10;
            } else {
                log("å®Ÿå®¶ã®å¸ƒå›£ã¯æœ€é«˜ã ã€‚");
            }
        }
        else if (type === 'eat_mom') {
            if(state.money >= 500) {
                state.money -= 500;
                state.food = state.maxFood;
                log("ãƒãƒã®ã‚«ãƒ¬ãƒ¼ã‚’é£Ÿã¹ãŸã€‚ã†ã¾ã„ã€‚");
            } else {
                log("é‡‘ãŒãªã„ãªã‚‰å†·è”µåº«ã®æ°·ã§ã‚‚èˆã‚ã¦ãªï¼", "bad");
            }
        }
        else if (type === 'buy') {
            if(param === 'onigiri' && pay(300)) {
                state.food += 30;
                log("ãƒ‘ã‚µãƒ‘ã‚µã®ãŠã«ãã‚Šã‚’é£Ÿã¹ãŸã€‚");
            }
            else if(param === 'zero' && pay(200)) {
                state.stress -= 30;
                state.hp -= 10;
                log("ã‚¢ãƒ«ã‚³ãƒ¼ãƒ«ãŒäº”è‡“å…­è…‘ã«æŸ“ã¿æ¸¡ã‚‹ï¼(ä½“ã«ã¯æ‚ªã„)");
            }
            else if(param === 'suit' && pay(20000)) {
                state.inventory.suit = true;
                log("ã‚¹ãƒ¼ãƒ„ã‚’è²·ã£ãŸï¼ã“ã‚Œã§ã¾ã¨ã‚‚ãªä»•äº‹ãŒã§ãã‚‹ã€‚");
            }
        }
        else if (type === 'change_job') {
            if(param === 'apology' && !state.inventory.suit) {
                alert("ã“ã®ä»•äº‹ã«ã¯ã‚¹ãƒ¼ãƒ„ãŒå¿…è¦ã§ã™ï¼ï¼ˆã‚³ãƒ³ãƒ“ãƒ‹ã§è²·ãˆã¾ã™ï¼‰");
                return;
            }
            state.job = param;
            log(`${jobs[param].name}ã«è»¢è·ã—ãŸï¼`);
            updatePlayerPos();
        }
        else if (type === 'work_can') {
            state.food -= 10;
            state.stress += 10;
            const earn = 300 + Math.floor(Math.random() * 500);
            state.money += earn;
            log(`ç©ºãç¼¶ã‚’æ‹¾ã£ã¦ ${earn}å†† ã«ãªã£ãŸã€‚è…°ãŒç—›ã„ã€‚`);
        }
        else if (type === 'work_apology') {
            state.food -= 20;
            state.stress += 40; // High risk
            const earn = 10000 + Math.floor(Math.random() * 5000);
            state.money += earn;
            log(`åœ°é¢ã«é ­ã‚’æ“¦ã‚Šä»˜ã‘ ${earn}å†† ç¨¼ã„ã ã€‚ãƒ—ãƒ©ã‚¤ãƒ‰ã¯æ­»ã‚“ã ã€‚`);
            
            if(Math.random() < 0.2) {
                log("å®¢ã«é ­ã‚’è¸ã¾ã‚ŒãŸï¼(HP-30)", "bad");
                state.hp -= 30;
            }
        }
        else if (type === 'work_monitor') {
            state.food -= 5;
            const earn = 5000;
            state.money += earn;
            const sideEffect = Math.random();
            if(sideEffect < 0.3) {
                log("å‰¯ä½œç”¨ã§é«ªãŒæŠœã‘ãŸã€‚(ã‚¹ãƒˆãƒ¬ã‚¹+30)", "bad");
                state.stress += 30;
            } else if (sideEffect < 0.6) {
                log("çŒ›çƒˆãªåãæ°—ï¼(HP-40)", "bad");
                state.hp -= 40;
            } else {
                log("ç‰¹ã«ä½•ã‚‚èµ·ããªã‹ã£ãŸã€‚ãƒ©ãƒƒã‚­ãƒ¼ã€‚", "good");
            }
        }
        else if (type === 'heal_hp' && pay(5000)) {
            state.hp = state.maxHp;
            log("è¬ã®æ³¨å°„ã§å…ƒæ°—ã«ãªã£ãŸï¼");
        }
        else if (type === 'heal_stress' && pay(3000)) {
            state.stress = 0;
            log("å¿ƒãŒè»½ããªã£ãŸï¼ˆè–¬ç‰©çš„ãªæ„å‘³ã§ï¼‰ã€‚");
        }
        else if (type === 'rest_park') {
            state.hp += 10;
            state.food -= 10;
            log("ãƒ™ãƒ³ãƒã§ä»®çœ ã—ãŸã€‚èšŠã«åˆºã•ã‚ŒãŸã€‚");
        }

        // Clamp values
        if(state.food > 100) state.food = 100;
        if(state.stress < 0) state.stress = 0;
        if(state.hp > 100) state.hp = 100;

        updateUI();
        checkGameOver();
    }

    function pay(amount) {
        if(state.money >= amount) {
            state.money -= amount;
            return true;
        }
        alert("é‡‘ãŒè¶³ã‚Šãªã„ï¼ï¼ï¼");
        return false;
    }

    // --- System & Utils ---

    function randomEvent() {
        const events = [
            { text: "è·å‹™è³ªå•ã•ã‚ŒãŸã€‚ã€Œè·æ¥­ã¯ï¼Ÿã€ã¨èã‹ã‚Œ30åˆ†ãƒ­ã‚¹ã€‚", cost: 0, dmg: 0, stress: 10 },
            { text: "ãƒã‚±ãƒƒãƒˆã«100å††å…¥ã£ã¦ãŸã€‚", cost: -100, dmg: 0, stress: 0 },
            { text: "ã‚«ãƒ©ã‚¹ã«è¥²ã‚ã‚ŒãŸï¼", cost: 0, dmg: 10, stress: 5 },
            { text: "å®—æ•™ã®å‹§èª˜ã‚’å—ã‘ãŸã€‚", cost: 0, dmg: 0, stress: 5 },
            { text: "é´ç´ãŒåˆ‡ã‚ŒãŸã€‚ä¸å‰ã ã€‚", cost: 0, dmg: 0, stress: 5 }
        ];
        const ev = events[Math.floor(Math.random() * events.length)];
        
        log(`ã€ã‚¤ãƒ™ãƒ³ãƒˆã€‘${ev.text}`, "bad");
        state.money -= ev.cost; // Negative cost adds money
        state.hp -= ev.dmg;
        state.stress += ev.stress;
    }

    function checkGameOver() {
        if(state.hp <= 0) {
            alert("ã€æ­»äº¡ã€‘\nã»ã†ã›ã„ã¯åŠ›å°½ããŸ...");
            respawn("ç—…é™¢ã«é‹ã°ã‚Œè˜‡ç”Ÿã—ãŸã€‚");
        }
        else if(state.stress >= 100) {
            alert("ã€ç™ºç‹‚ã€‘\nã‚¹ãƒˆãƒ¬ã‚¹ã§é™ç•Œã‚’è¿ãˆã€è¡—ä¸­ã§æš´ã‚Œã¾ã‚ã£ãŸï¼");
            respawn("ç²¾ç¥ç§‘ã«å¼·åˆ¶å…¥é™¢ã•ã›ã‚‰ã‚ŒãŸã€‚");
        }
    }

    function respawn(reason) {
        const penalty = Math.floor(state.money / 2) + 1000;
        state.money -= penalty;
        if(state.money < 0) state.money = 0;
        
        state.hp = 50;
        state.stress = 0;
        state.food = 50;
        state.x = 1; state.y = 1; // Back home
        
        log(reason, "bad");
        log(`æ²»ç™‚è²»ã¨è³ å„Ÿé‡‘ã§ ${penalty}å†† å¤±ã£ãŸ...`, "bad");
        updatePlayerPos();
        updateUI();
    }

    function log(msg, type) {
        const div = document.createElement('div');
        div.innerText = `> ${msg}`;
        if(type === 'bad') div.style.color = '#e74c3c';
        if(type === 'good') div.style.color = '#f1c40f';
        const box = document.getElementById('log-box');
        box.insertBefore(div, box.firstChild);
    }

    function updateUI() {
        document.getElementById('s-money').innerText = state.money;
        
        const hpEl = document.getElementById('s-hp');
        hpEl.innerText = state.hp;
        if(state.hp < 30) hpEl.className = 'danger';
        else hpEl.className = '';

        const foodEl = document.getElementById('s-food');
        foodEl.innerText = state.food;
        if(state.food < 20) foodEl.className = 'danger';
        else foodEl.className = '';

        const stressEl = document.getElementById('s-stress');
        stressEl.innerText = state.stress;
        if(state.stress > 80) stressEl.className = 'danger';
        else stressEl.className = '';

        document.getElementById('s-job').innerText = jobs[state.job].name;
    }

    function openModal(title, content) {
        document.getElementById('modal-title').innerText = title;
        document.getElementById('modal-body').innerHTML = content;
        document.getElementById('modal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('modal').style.display = 'none';
    }

    // Key Listeners
    window.addEventListener('keydown', (e) => {
        if(e.key === 'ArrowUp') move(0, -1);
        if(e.key === 'ArrowDown') move(0, 1);
        if(e.key === 'ArrowLeft') move(-1, 0);
        if(e.key === 'ArrowRight') move(1, 0);
        if(e.key === 'Enter' || e.key === ' ') interact();
    });

    initMap();

</script>
</body>
</html>
